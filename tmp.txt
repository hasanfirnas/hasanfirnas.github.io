function main(workbook: ExcelScript.Workbook, ritmId: string) {
  const outputSheet = workbook.getWorksheet("output");
  const formsSheet = workbook.getWorksheet("Sheet1");
  const outputTable = outputSheet.getTable("OutputTable");
  const formsTable = formsSheet.getTable("OfficeForms.Table");
  
  // Search for RITM in OutputTable column C
  const outputData = outputTable.getRangeBetweenHeaderAndTotal().getValues();
  
  for (let i = 0; i < outputData.length; i++) {
    if (outputData[i][2] && outputData[i][2].toString().includes(ritmId)) {
      const rowId = outputData[i][0]?.toString() || "";
      
      // Search for this rowId in FormsTable
      const formsData = formsTable.getRangeBetweenHeaderAndTotal().getValues();
      
      for (let j = 0; j < formsData.length; j++) {
        if (formsData[j][0] && formsData[j][0].toString() === rowId) {
          // Check if row is striked and colored
          const rowRange = formsTable.getRangeBetweenHeaderAndTotal().getRow(j);
          let hasStrikethrough = false;
          
          // Check strikethrough
          for (let col = 0; col < 10; col++) {
            try {
              if (rowRange.getCell(0, col).getFormat().getFont().getStrikethrough()) {
                hasStrikethrough = true;
                break;
              }
            } catch { break; }
          }
          
          // Check color
          const cellColor = rowRange.getCell(0, 0).getFormat().getFill().getColor();
          const isColored = (cellColor === "ff0000" || cellColor === "ffff00");
          
          if (hasStrikethrough && isColored) {
            console.log(JSON.stringify({status: "NEW"}));
            return;
          }
          
          // Not striked, get email from column D
          const email = formsData[j][3]?.toString() || "";
          console.log(JSON.stringify({
            RITM_ID: ritmId,
            ID: rowId,
            Email: email,
            status: "FOUND"
          }));
          return;
        }
      }
      break;
    }
  }
  
  // RITM not found
  console.log(JSON.stringify({status: "NEW"}));
}
