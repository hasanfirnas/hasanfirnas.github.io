function main(workbook: ExcelScript.Workbook) {
  // Get the worksheets
  let sheet1 = workbook.getWorksheet("Sheet1");
  let sheet3 = workbook.getWorksheet("Sheet3");

  // Get the data ranges and explicitly define types
  let sheet1B: (string | number | boolean)[][] = sheet1.getRange("B2:B" + sheet1.getUsedRange().getLastRow() + 1).getValues();
  let sheet3E: (string | number | boolean)[][] = sheet3.getRange("E2:E" + sheet3.getUsedRange().getLastRow() + 1).getValues();
  let sheet3B: (string | number | boolean)[][] = sheet3.getRange("B2:B" + sheet3.getUsedRange().getLastRow() + 1).getValues();

  // Prepare an array to store output for Sheet1, Column A
  let output: (string | number)[][] = [];

  // Loop through each row in Sheet1, Column B
  for (let i = 0; i < sheet1B.length; i++) {
    let searchValue = sheet1B[i][0]?.toString().trim(); // Get the value from Sheet1, Column B
    let matched = false;

    // Check against each row in Sheet3, Column E
    for (let j = 0; j < sheet3E.length; j++) {
      let cellValue = sheet3E[j][0]?.toString(); // Get the value from Sheet3, Column E
      
      // Use regex to extract "DB instance" value if present
      let match = cellValue.match(/DB instance:\s*(.*?)<\/li>/);
      let extractedValue = match ? match[1].trim() : null;

      // Check if the extracted value matches the search value
      if (searchValue && extractedValue === searchValue) {
        output.push([sheet3B[j][0]]); // Push the corresponding Sheet3, Column B value
        matched = true;
        break; // Stop searching once a match is found
      }
    }

    // If no match, add an empty string to the output
    if (!matched) {
      output.push([""]);
    }
  }

  // Write the results to Sheet1, Column A
  sheet1.getRange("A2:A" + (output.length + 1)).setValues(output);
}