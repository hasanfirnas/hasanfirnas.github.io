function main(workbook: ExcelScript.Workbook, ritmId: string) {
  try {
    const outputTable = workbook.getWorksheet("output").getTable("OutputTable");
    const formsTable = workbook.getWorksheet("Sheet1").getTable("OfficeForms.Table");
    
    const outputData = outputTable.getRangeBetweenHeaderAndTotal().getValues();
    
    for (let i = 0; i < outputData.length; i++) {
      const ritmCell = outputData[i][2];
      if (ritmCell && ritmCell.toString().includes(ritmId)) {
        const rowId = outputData[i][0]?.toString() || "";
        const formsData = formsTable.getRangeBetweenHeaderAndTotal().getValues();
        
        for (let j = 0; j < formsData.length; j++) {
          const idCell = formsData[j][0];
          if (idCell && idCell.toString() === rowId) {
            const rowRange = formsTable.getRangeBetweenHeaderAndTotal().getRow(j);
            
            // Check ONLY strikethrough on first cell (ID cell in column A)
            const firstCell = rowRange.getCell(0, 0);
            const hasStrikethrough = firstCell.getFormat().getFont().getStrikethrough();
            
            // If striked → NEW
            if (hasStrikethrough) {
              console.log(JSON.stringify({status: "NEW"}));
              return;
            }
            
            // Not striked → FOUND with email
            const email = formsData[j][3]?.toString() || "";
            console.log(JSON.stringify({
              RITM_ID: ritmId,
              ID: rowId,
              Email: email,
              status: "FOUND"
            }));
            return;
          }
        }
        break;
      }
    }
  } catch { }
  
  console.log(JSON.stringify({status: "ENEW"}));
}
