import pandas as pd
from openpyxl import load_workbook

# Load the Excel file
file_path = 'your_excel_file.xlsx'
sheet1 = pd.read_excel(file_path, sheet_name='1')
sheet2 = pd.read_excel(file_path, sheet_name='2')

# Group sheet2 by 'CI ID' and aggregate all 'Name.1' column values into a single string
sheet2_grouped = sheet2.groupby('CI ID')['Name.1'].apply(lambda x: ', '.join(x.astype(str))).reset_index()

# Merge the grouped data with sheet1 on 'CI ID'
sheet1_updated = pd.merge(sheet1, sheet2_grouped, on='CI ID', how='left')

# Load the workbook and select the sheet you want to modify
wb = load_workbook(file_path)
ws = wb['1']

# Update only the 'L' column with the merged data
for idx, value in enumerate(sheet1_updated['Name.1'], start=2):  # start=2 because Excel is 1-indexed, and you want to skip header
    ws[f'L{idx}'] = value

# Save the workbook without altering any other formatting
wb.save(file_path)

print("Data added to existing file without changing formatting.")