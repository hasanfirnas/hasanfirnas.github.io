function main(workbook: ExcelScript.Workbook, combinedInput: string) {
  const [RITM, latestID] = combinedInput.split(",");

  const sheet = workbook.getWorksheet("Sheet1"); // Adjust if needed
  const table = sheet.getTable("Table1");        // Adjust if needed

  const headers = table.getHeaderRowRange().getValues()[0];
  const values = table.getRangeBetweenHeaderAndTotal().getValues();
  const formats = table.getRangeBetweenHeaderAndTotal().getFormat();

  const ritmColIndex = headers.indexOf("RITM");
  const idColIndex = headers.indexOf("ID");

  let matchingRows: number[] = [];

  for (let i = 0; i < values.length; i++) {
    if (values[i][ritmColIndex]?.toString().trim() === RITM) {
      matchingRows.push(i);
    }
  }

  if (matchingRows.length <= 1) return;

  for (let rowIndex of matchingRows) {
    const rowID = values[rowIndex][idColIndex]?.toString().trim();
    if (rowID !== latestID) {
      const fullRow = table.getRangeBetweenHeaderAndTotal().getCell(rowIndex, 0).getEntireRow();
      fullRow.getFormat().getFont().setStrikethrough(true);
      fullRow.getFormat().getFill().setColor("#FF9999"); // Light red
    }
  }
}



function main(workbook: ExcelScript.Workbook) {
  const sheet = workbook.getActiveWorksheet();
  const tables = sheet.getTables();
  for (let t of tables) {
    console.log(t.getName());
  }
}
