import pandas as pd

# Load the Excel file
file_path = 'your_excel_file.xlsx'
sheet1 = pd.read_excel(file_path, sheet_name='1')
sheet2 = pd.read_excel(file_path, sheet_name='2')

# Group sheet2 by 'CI ID' and aggregate all 'Name.1' column values into a single string
sheet2_grouped = sheet2.groupby('CI ID')['Name.1'].apply(lambda x: ', '.join(x.astype(str))).reset_index()

# Merge the grouped data with sheet1 on 'CI ID'
sheet1 = pd.merge(sheet1, sheet2_grouped, on='CI ID', how='left')

# Rename the new 'Name.1' column in sheet1 to 'L' to match your desired output
sheet1.rename(columns={'Name.1': 'L'}, inplace=True)

# Now, update the original file by writing back to sheet '1' only
with pd.ExcelWriter(file_path, engine='openpyxl', mode='a', if_sheet_exists='replace') as writer:
    sheet1.to_excel(writer, sheet_name='1', index=False)

print("Lookup complete. Existing file updated.")